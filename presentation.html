<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Báo Cáo - Phân loại Rầy Nâu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Đảm bảo html2canvas và jsPDF có sẵn
        window.html2canvas = window.html2canvas || html2canvas;
    </script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: #f0f2f5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Download Button */
        .download-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .download-btn i {
            margin-right: 10px;
        }

        /* Slide Container */
        .slide-section {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
            page-break-after: always;
            page-break-inside: avoid;
            break-after: page;
            break-inside: avoid;
        }
        
        @media print {
            .slide-section {
                page-break-after: always;
                page-break-inside: avoid;
            }
            
            .download-btn {
                display: none !important;
            }
        }

        .slide-container {
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            width: 1280px;
            min-height: 720px;
            max-height: 720px;
            padding: 0;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Import styles from styles.css */
        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
        }

        h2.slide-title {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: -1px;
        }

        h3 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        p, li {
            font-size: 20px;
            line-height: 1.6;
            color: #37474f;
            margin-bottom: 12px;
        }

        ul {
            list-style: none;
            padding: 0;
        }

        ul li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        ul li i {
            font-size: 18px;
            margin-right: 12px;
            min-width: 20px;
            padding-top: 3px;
        }

        b {
            color: #2e7d32;
            font-weight: 700;
        }

        /* Title Layout */
        .title-layout {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .title-layout h1 {
            font-size: 56px;
            font-weight: 800;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .title-layout .subtitle {
            font-size: 32px;
            font-weight: 300;
            margin-bottom: 50px;
            opacity: 0.95;
        }

        .title-layout .members {
            margin-top: 60px;
            font-size: 24px;
        }

        .title-layout .members p {
            color: white;
            margin-bottom: 15px;
            font-size: 22px;
        }

        /* Content Layout */
        .content-layout {
            padding: 40px 50px;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-layout h2.slide-title {
            font-size: 38px;
            margin-bottom: 25px;
            flex-shrink: 0;
            color: #1565c0;
        }

        .content-layout .content-body {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .content-layout ul li {
            font-size: 19px;
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .content-layout p {
            font-size: 19px;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        /* Two Column Layout */
        .two-col-layout {
            padding: 40px 50px;
            height: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            overflow: hidden;
        }

        .two-col-layout .col {
            overflow-y: auto;
            padding-right: 10px;
        }

        .section-title {
            color: #558b2f;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 15px;
            border-bottom: 3px solid #a5d6a7;
            padding-bottom: 8px;
        }

        /* Grid Content */
        .grid-body {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #00796b;
        }

        .grid-item h3 {
            font-size: 22px;
            color: #00796b;
            margin-bottom: 12px;
        }

        .grid-item ul li {
            font-size: 17px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        /* Steps Layout */
        .steps-layout {
            padding: 0;
        }

        .step-item {
            display: flex;
            margin-bottom: 18px;
            align-items: flex-start;
        }

        .step-number {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 700;
            flex-shrink: 0;
            margin-right: 18px;
        }

        .step-content {
            flex: 1;
        }

        .step-content h3 {
            font-size: 24px;
            color: #1565c0;
            margin-bottom: 8px;
        }

        .step-content p {
            font-size: 18px;
            line-height: 1.5;
        }

        /* TOC Layout */
        .toc-layout {
            padding: 40px 50px;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .toc-layout h2.slide-title {
            font-size: 40px;
            margin-bottom: 30px;
            text-align: center;
            color: #1565c0;
        }

        .toc-list {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .toc-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            margin-bottom: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #00796b;
        }

        .toc-item .toc-number {
            font-size: 24px;
            font-weight: 700;
            color: #00796b;
            margin-right: 20px;
            min-width: 50px;
        }

        .toc-item .toc-text {
            font-size: 20px;
            color: #37474f;
            font-weight: 500;
        }

        /* Navigation Controls */
        .nav-controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s, opacity 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .slide-counter {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            color: #37474f;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* Hide all slides by default, show only active when not in fullscreen */
        body:not(.fullscreen) .slide-section {
            display: none;
        }

        body:not(.fullscreen) .slide-section.active {
            display: flex;
        }

        /* In fullscreen, only show active slide */
        body.fullscreen .slide-section {
            display: none;
        }

        body.fullscreen .slide-section.active {
            display: flex;
        }

        /* Fullscreen Mode - Scale 16:9 container to fit screen */
        body.fullscreen {
            overflow: hidden;
            background: #000;
        }

        body.fullscreen .slide-section.active {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1000;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        body.fullscreen .slide-container {
            /* Scale to fit screen while maintaining 16:9 aspect ratio */
            width: min(100vw, 100vh * 16 / 9);
            height: min(100vh, 100vw * 9 / 16);
            max-width: 100vw;
            max-height: 100vh;
            border-radius: 0;
            box-shadow: none;
            transform: scale(1);
        }

        body.fullscreen .nav-controls {
            bottom: 20px;
        }

        body.fullscreen .download-btn {
            display: none;
        }

        body.fullscreen .thumbnail-bar {
            display: none;
        }

        body.fullscreen .fullscreen-btn {
            background: rgba(102, 126, 234, 0.8);
        }

        /* Thumbnail Navigation Bar */
        .thumbnail-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            border-top: 2px solid #e0e0e0;
            padding: 15px;
            z-index: 999;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            overflow-y: hidden;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            max-height: 150px;
            scroll-behavior: smooth;
            /* Hide scrollbar but keep functionality */
            scrollbar-width: thin;
            scrollbar-color: #667eea #f0f0f0;
        }

        .thumbnail-bar::-webkit-scrollbar {
            height: 8px;
        }

        .thumbnail-bar::-webkit-scrollbar-track {
            background: #f0f0f0;
        }

        .thumbnail-bar::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 4px;
        }

        .thumbnail-bar::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .thumbnail-item {
            flex-shrink: 0;
            width: 120px;
            height: 80px;
            border: 3px solid transparent;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }

        .thumbnail-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .thumbnail-item.active {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
        }

        .thumbnail-item img,
        .thumbnail-item canvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .thumbnail-number {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            text-align: center;
            font-size: 12px;
            padding: 3px;
            font-weight: 600;
        }

        /* Fullscreen Toggle Button */
        .fullscreen-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .fullscreen-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        body.fullscreen .fullscreen-btn {
            top: 10px;
            left: 10px;
        }

        /* Click to advance */
        .slide-section {
            cursor: pointer;
        }

        body.fullscreen .slide-section {
            cursor: pointer;
        }

        @media print {
            .nav-controls,
            .thumbnail-bar,
            .fullscreen-btn,
            .download-btn {
                display: none !important;
            }
            
            .slide-section {
                display: flex !important;
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <!-- Download Button -->
    <button class="download-btn" onclick="downloadPDF()">
        <i class="fa-solid fa-file-pdf"></i>
        Tải PDF
    </button>

    <!-- Fullscreen Toggle Button -->
    <button class="fullscreen-btn" onclick="toggleFullscreen()" id="fullscreenBtn">
        <i class="fa-solid fa-expand"></i>
        Toàn màn hình
    </button>

    <!-- Navigation Controls -->
    <div class="nav-controls">
        <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">
            <i class="fa-solid fa-chevron-left"></i>
            Trước
        </button>
        <div class="slide-counter">
            <span id="currentSlide">1</span> / <span id="totalSlides">1</span>
        </div>
        <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">
            Tiếp
            <i class="fa-solid fa-chevron-right"></i>
        </button>
    </div>

    <!-- SLIDE 1: Đề tài và Thành viên -->
    <section class="slide-section active" data-slide="1" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container" style="background: white;">
            <div style="padding: 40px 50px; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
                <!-- Header -->
                <div style="margin-bottom: 60px; color: #666;">
                    <p style="font-size: 18px; margin-bottom: 5px; font-weight: 500;">BỘ CÔNG THƯƠNG</p>
                    <p style="font-size: 18px; margin-bottom: 5px; font-weight: 500;">TRƯỜNG ĐẠI HỌC CÔNG THƯƠNG TP. HỒ CHÍ MINH</p>
                    <p style="font-size: 18px; font-weight: 500;">KHOA CÔNG NGHỆ THÔNG TIN</p>
                </div>

                <!-- Main Title -->
                <h1 style="font-size: 48px; font-weight: 800; color: #1565c0; margin-bottom: 30px; line-height: 1.2; font-family: 'Montserrat', sans-serif;">
                    PHÂN LOẠI GIỐNG VÀ XÁC ĐỊNH MẬT ĐỘ RẦY NÂU TRÊN<br>CÂY LÚA
                </h1>

                <!-- Subtitle -->
                <p style="font-size: 36px; font-weight: 700; color: #333; margin-bottom: 80px; font-family: 'Montserrat', sans-serif;">
                    ỨNG DỤNG MÔ HÌNH KẾT HỢP SAM - VIT
                </p>

                <!-- Info Box -->
                <div style="background: #f5f5f5; padding: 30px 40px; border-radius: 12px; text-align: left; max-width: 600px; margin-top: auto; margin-bottom: 40px;">
                    <p style="font-size: 16px; color: #666; margin-bottom: 8px;">
                        <strong>Môn học:</strong> Các vấn đề hiện đại trong Trí tuệ nhân tạo
                    </p>
                    <p style="font-size: 16px; color: #666; margin-bottom: 8px;">
                        <strong>GVHD:</strong> TS. Phùng Thế Bảo
                    </p>
                    <p style="font-size: 16px; color: #666;">
                        <strong>Nhóm SV:</strong> Phạm Tấn Thuận & Lý Dạ Lan
                    </p>
                </div>

                <!-- Slide Number -->
                <div style="position: absolute; bottom: 20px; left: 20px; font-size: 14px; color: #999;">
                    1
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 2: Mục lục -->
    <section class="slide-section" data-slide="2" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container" style="background: white;">
            <div style="padding: 50px; height: 100%; display: flex; flex-direction: column;">
                <!-- Title -->
                <h2 style="font-size: 42px; font-weight: 800; color: #1565c0; text-align: center; margin-bottom: 20px; font-family: 'Montserrat', sans-serif;">
                    NỘI DUNG TRÌNH BÀY
                </h2>
                
                <!-- Separator -->
                <div style="height: 3px; background: #4caf50; width: 100%; margin-bottom: 40px;"></div>
                
                <!-- Two Column Layout -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; flex: 1; overflow-y: auto;">
                    <!-- Left Column -->
                    <div>
                        <div style="display: flex; align-items: flex-start; margin-bottom: 30px;">
                            <i class="fa-solid fa-book" style="font-size: 32px; color: #4caf50; margin-right: 15px; margin-top: 5px;"></i>
                            <div>
                                <h3 style="font-size: 24px; font-weight: 700; color: #333; margin-bottom: 8px; font-family: 'Montserrat', sans-serif;">
                                    Chương 1: Tổng quan đề tài
                                </h3>
                                <p style="font-size: 18px; color: #666; line-height: 1.5;">
                                    Đặt vấn đề, mục tiêu, phạm vi nghiên cứu.
                                </p>
                            </div>
                    </div>
                    
                        <div style="display: flex; align-items: flex-start; margin-bottom: 30px;">
                            <i class="fa-solid fa-microchip" style="font-size: 32px; color: #4caf50; margin-right: 15px; margin-top: 5px;"></i>
                            <div>
                                <h3 style="font-size: 24px; font-weight: 700; color: #333; margin-bottom: 8px; font-family: 'Montserrat', sans-serif;">
                                    Chương 2: Cơ sở lý thuyết
                                </h3>
                                <p style="font-size: 18px; color: #666; line-height: 1.5;">
                                    CV, YOLO, SAM, Vision Transformer.
                                </p>
                            </div>
                    </div>
                    
                        <div style="display: flex; align-items: flex-start; margin-bottom: 30px;">
                            <i class="fa-solid fa-cogs" style="font-size: 32px; color: #4caf50; margin-right: 15px; margin-top: 5px;"></i>
                            <div>
                                <h3 style="font-size: 24px; font-weight: 700; color: #333; margin-bottom: 8px; font-family: 'Montserrat', sans-serif;">
                                    Chương 3: Thiết kế hệ thống
                                </h3>
                                <p style="font-size: 18px; color: #666; line-height: 1.5;">
                                    Kiến trúc Pipeline, Xử lý dữ liệu, Tích hợp.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Column -->
                    <div>
                        <div style="display: flex; align-items: flex-start; margin-bottom: 30px;">
                            <i class="fa-solid fa-chart-line" style="font-size: 32px; color: #4caf50; margin-right: 15px; margin-top: 5px;"></i>
                            <div>
                                <h3 style="font-size: 24px; font-weight: 700; color: #333; margin-bottom: 8px; font-family: 'Montserrat', sans-serif;">
                                    Chương 4: Kết quả thực nghiệm
                                </h3>
                                <p style="font-size: 18px; color: #666; line-height: 1.5;">
                                    Training metrics, Phân tích mật độ, Visualization.
                                </p>
                            </div>
                    </div>
                    
                        <div style="display: flex; align-items: flex-start; margin-bottom: 30px;">
                            <i class="fa-solid fa-flag-checkered" style="font-size: 32px; color: #4caf50; margin-right: 15px; margin-top: 5px;"></i>
                            <div>
                                <h3 style="font-size: 24px; font-weight: 700; color: #333; margin-bottom: 8px; font-family: 'Montserrat', sans-serif;">
                                    Kết luận & Hướng phát triển
                                </h3>
                                <p style="font-size: 18px; color: #666; line-height: 1.5;">
                                    Tổng kết đóng góp và đề xuất mở rộng.
                                </p>
                    </div>
                        </div>
                    </div>
                </div>

                <!-- Slide Number -->
                <div style="position: absolute; bottom: 20px; left: 20px; font-size: 14px; color: #999;">
                    2
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 3: Đặt vấn đề -->
    <section class="slide-section" data-slide="3" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="two-col-layout">
                <div class="col">
                    <h2 class="slide-title" style="color: #1b5e20; font-size: 36px; margin-bottom: 25px;">
                        1. Bối cảnh & Thách thức
                    </h2>
                    
                    <div class="section-title">Thách thức Truyền thống</div>
                    <ul>
                        <li><i class="fa-solid fa-seedling" style="color: #2e7d32;"></i> <b>Lúa:</b> Cây trồng chủ lực, chịu thiệt hại nặng nề từ <b>rầy nâu</b> và sâu bệnh.</li>
                        <li><i class="fa-solid fa-clock" style="color: #f57c00;"></i> <b>Giám sát thủ công:</b> Tốn <b>thời gian</b>, <b>chi phí</b>, và <b>độ chính xác thấp</b> (dựa vào kinh nghiệm).</li>
                        <li><i class="fa-solid fa-map-location-dot" style="color: #607d8b;"></i> <b>Quy mô lớn:</b> Khó đưa ra cảnh báo <b>kịp thời và khách quan</b> trên diện rộng.</li>
                    </ul>
                    
                    <div class="section-title">Giải pháp AI & Giới hạn</div>
                    <ul>
                        <li><i class="fa-solid fa-robot" style="color: #03a9f4;"></i> <b>AI & YOLO:</b> Đã giải quyết tốt bài toán <b>Phát hiện (Detection)</b> và <b>Phân loại</b> rầy.</li>
                        <li><i class="fa-solid fa-square" style="color: #c62828;"></i> <b>Hộp bao (Bounding Box):</b> Chỉ là <b>vùng ước lượng</b> bao quanh đối tượng.</li>
                    </ul>
                </div>
                
                <div class="col">
                    <h2 class="slide-title" style="color: #c62828; font-size: 36px; margin-bottom: 25px;">
                        2. Khoảng trống Nghiên cứu
                    </h2>
                    
                    <div class="section-title" style="border-bottom-color: #ef9a9a;">Thách thức về Độ chính xác</div>
                    <ul>
                        <li><i class="fa-solid fa-slash" style="color: #c62828;"></i> <b>KHÔNG</b> thể tách biệt rầy khỏi nền lá lúa ở mức độ <b>pixel-level</b>.</li>
                        <li><i class="fa-solid fa-exclamation-triangle" style="color: #ff9800;"></i> Khó tính toán <b>mật độ chính xác</b> từ bounding boxes.</li>
                    </ul>
                    
                    <div class="section-title" style="border-bottom-color: #ef9a9a;">Nhu cầu Cấp thiết</div>
                    <ul>
                        <li><i class="fa-solid fa-mask" style="color: #3f51b5;"></i> Cần <b>Phân đoạn thực thể (Instance Segmentation)</b>.</li>
                        <li><i class="fa-solid fa-calculator" style="color: #3f51b5;"></i> Yếu tố then chốt để tính <b>Mật độ rầy/m²</b> một cách <b>khoa học và chính xác</b>.</li>
                        <li><i class="fa-solid fa-chart-line" style="color: #3f51b5;"></i> Hỗ trợ đánh giá mức độ xâm nhiễm và dự báo dịch hại.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 4: Nghiên cứu liên quan -->
    <section class="slide-section" data-slide="4" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title">1.2. Nghiên cứu liên quan</h2>
                
                <div class="content-body">
                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3 style="color: #2196f3;">
                                <i class="fa-solid fa-microscope" style="margin-right: 10px;"></i>
                                RPH-Counter (2024)
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Mạng Fully Convolutional Network (FCN)</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Kết quả: F1 = 92.36%, MAE = 2.40, R² = 0.985</li>
                                <li><i class="fa-solid fa-times" style="color: #f44336;"></i> <b>Hạn chế:</b> Chỉ phát hiện và đếm, chưa có segmentation pixel-level</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #ff9800;">
                            <h3 style="color: #ff9800;">
                                <i class="fa-solid fa-brain" style="margin-right: 10px;"></i>
                                SwinT-YOLOv8-p2 (2025)
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Tích hợp Swin Transformer và SCConv</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Kết quả: mAP@0.5 = 0.847, F1 = 0.899</li>
                                <li><i class="fa-solid fa-times" style="color: #f44336;"></i> <b>Hạn chế:</b> Dựa trên bounding boxes, chưa phân đoạn từng cá thể</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #9c27b0;">
                            <h3 style="color: #9c27b0;">
                                <i class="fa-solid fa-network-wired" style="margin-right: 10px;"></i>
                                U-Net, Mask R-CNN, DeepLabV3+
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Được áp dụng cho phân đoạn bệnh lá</li>
                                <li><i class="fa-solid fa-times" style="color: #f44336;"></i> <b>Hạn chế:</b> Phụ thuộc nhiều vào dữ liệu gán nhãn thủ công</li>
                                <li><i class="fa-solid fa-times" style="color: #f44336;"></i> Giảm hiệu suất trong điều kiện thực địa phức tạp</li>
                            </ul>
                        </div>

                        <div style="background: #fff3cd; padding: 20px; border-radius: 12px; border-left: 4px solid #ffc107;">
                            <h3 style="color: #856404; margin-bottom: 10px;">
                                <i class="fa-solid fa-lightbulb" style="margin-right: 10px;"></i>
                                Nhận xét chung
                            </h3>
                            <p style="color: #856404; font-size: 18px; margin: 0;">
                                Hầu hết các nghiên cứu hiện nay tập trung vào <b>detection</b> hoặc <b>counting</b>, 
                                chưa khai thác <b>segmentation pixel-level</b> - yếu tố then chốt để đánh giá 
                                mật độ và mức độ xâm nhiễm chính xác.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 5: Giải pháp đề xuất -->
    <section class="slide-section" data-slide="5" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #009688;">3. Đề xuất Giải pháp Đột phá</h2>
                
                <div class="content-body">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #4db6ac; font-size: 32px; margin-bottom: 15px;">
                            Pipeline Hai giai đoạn: YOLO (Tốc độ) + SAM-ViT (Độ chính xác)
                        </h3>
                        <p style="color: #607d8b; font-size: 22px;">
                            Tận dụng ưu điểm của hai kiến trúc AI hàng đầu để giải quyết triệt để bài toán mật độ rầy.
                        </p>
                    </div>

                    <div style="display: flex; align-items: center; justify-content: center; gap: 30px; margin: 30px 0;">
                        <div style="background: #e0f2f1; padding: 30px; border-radius: 15px; width: 350px; border: 2px solid #009688;">
                            <div style="text-align: center; margin-bottom: 15px;">
                                <i class="fa-solid fa-magnifying-glass" style="font-size: 40px; color: #009688;"></i>
                            </div>
                            <h3 style="color: #00796b; font-size: 26px; margin-bottom: 12px; text-align: center;">
                                Giai đoạn 1: Phát hiện YOLO
                            </h3>
                            <p style="font-size: 18px; text-align: center; margin-bottom: 10px;">
                                Đảm nhận vai trò <b>phát hiện nhanh</b> và <b>phân loại</b> các đối tượng rầy.
                            </p>
                            <p style="color: #c62828; font-weight: 700; text-align: center; font-size: 18px;">
                                Output: Bounding Boxes (Prompts)
                            </p>
                        </div>

                        <i class="fa-solid fa-arrow-right" style="font-size: 50px; color: #009688;"></i>

                        <div style="background: #e3f2fd; padding: 30px; border-radius: 15px; width: 350px; border: 2px solid #1565c0;">
                            <div style="text-align: center; margin-bottom: 15px;">
                                <i class="fa-solid fa-puzzle-piece" style="font-size: 40px; color: #1565c0;"></i>
                            </div>
                            <h3 style="color: #1565c0; font-size: 26px; margin-bottom: 12px; text-align: center;">
                                Giai đoạn 2: Phân đoạn SAM-ViT
                            </h3>
                            <p style="font-size: 18px; text-align: center; margin-bottom: 10px;">
                                Sử dụng Bounding Boxes từ YOLO làm <b>gợi ý (Prompt)</b> để tạo <b>phân đoạn pixel-level</b> tinh vi.
                            </p>
                            <p style="color: #c62828; font-weight: 700; text-align: center; font-size: 18px;">
                                Output: Segmentation Masks
                            </p>
                        </div>
                    </div>

                    <div style="background: #ffcc80; padding: 25px; border-radius: 12px; text-align: center; margin-top: 20px;">
                        <h3 style="color: #e65100; font-size: 28px; margin-bottom: 10px;">
                            <i class="fa-solid fa-chart-simple" style="margin-right: 10px;"></i>
                            Mục tiêu Cuối cùng
                        </h3>
                        <p style="color: #e65100; font-size: 24px; font-weight: 700;">
                            Tính toán MẬT ĐỘ RẦY/M² Chính xác
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 6: Tính mới của đồ án -->
    <section class="slide-section" data-slide="6" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.2.2. Tính mới của đồ án</h2>
                
                <div class="content-body">
                    <div style="background: #e3f2fd; padding: 25px; border-radius: 12px; margin-bottom: 25px; border-left: 5px solid #2196f3;">
                        <h3 style="color: #1565c0; font-size: 28px; margin-bottom: 15px;">
                            <i class="fa-solid fa-lightbulb" style="margin-right: 10px;"></i>
                            Điểm Đột phá Chính
                        </h3>
                        <p style="font-size: 19px; line-height: 1.6;">
                            Kết hợp <b>YOLO</b> và <b>SAM-ViT</b> trong pipeline tuần tự - 
                            <b>chưa được áp dụng</b> cho bài toán rầy nâu trên cây lúa.
                        </p>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3 style="color: #4caf50;">
                                <i class="fa-solid fa-check-circle" style="margin-right: 10px;"></i>
                                1. Kết hợp YOLO và SAM-ViT
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-arrow-right" style="color: #4caf50;"></i> YOLO phát hiện và phân loại các đối tượng rầy</li>
                                <li><i class="fa-solid fa-arrow-right" style="color: #4caf50;"></i> SAM-ViT thực hiện phân đoạn pixel-level dựa trên bounding boxes</li>
                                <li><i class="fa-solid fa-arrow-right" style="color: #4caf50;"></i> Hướng tiếp cận <b>mới</b> cho bài toán rầy nâu</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #ff9800;">
                            <h3 style="color: #ff9800;">
                                <i class="fa-solid fa-cogs" style="margin-right: 10px;"></i>
                                2. Ưu điểm Kỹ thuật
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-mask" style="color: #ff9800;"></i> <b>SAM:</b> Sinh mặt nạ khởi tạo, tăng độ chính xác biên ranh giới, giảm nhiễu nền</li>
                                <li><i class="fa-solid fa-brain" style="color: #ff9800;"></i> <b>ViT:</b> Học biểu diễn toàn cục, nhận diện tốt các cá thể nhỏ, phân tán và bị che khuất</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #9c27b0;">
                            <h3 style="color: #9c27b0;">
                                <i class="fa-solid fa-star" style="margin-right: 10px;"></i>
                                3. Khác biệt so với Nghiên cứu trước
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> Có <b>segmentation pixel-level</b>, không chỉ detection</li>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> Đánh giá mật độ và mức độ xâm nhiễm chính xác theo không gian</li>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> Mở ra khả năng ứng dụng mở rộng trong nông nghiệp thông minh</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 7: Mục tiêu tổng quát -->
    <section class="slide-section" data-slide="7" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.3. Mục tiêu nghiên cứu</h2>
                <h3 style="color: #00796b; font-size: 32px; margin-bottom: 25px;">1.3.1. Mục tiêu tổng quát</h3>
                
                <div class="content-body">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px; border-radius: 15px; color: white; text-align: center; margin-bottom: 30px;">
                        <h3 style="color: white; font-size: 32px; margin-bottom: 20px;">
                            <i class="fa-solid fa-bullseye" style="margin-right: 15px;"></i>
                            Mục tiêu Tổng quát
                        </h3>
                        <p style="font-size: 22px; line-height: 1.8; color: white;">
                            Xây dựng hệ thống <b>phát hiện, phân loại và phân đoạn</b> rầy nâu trên cây lúa 
                            bằng pipeline <b>YOLO + SAM-ViT</b>, sử dụng bộ dữ liệu thực địa từ nghiên cứu 
                            SwinT-YOLOv8-p2, nhằm <b>tăng độ chính xác</b> nhận diện vùng rầy nâu và 
                            <b>tính toán mật độ chính xác</b> phục vụ giám sát dịch hại tự động.
                        </p>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3><i class="fa-solid fa-seedling" style="margin-right: 10px;"></i>Ứng dụng</h3>
                            <p style="font-size: 18px;">Giám sát dịch hại tự động trong nông nghiệp thông minh</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3><i class="fa-solid fa-chart-line" style="margin-right: 10px;"></i>Kết quả</h3>
                            <p style="font-size: 18px;">Tăng độ chính xác nhận diện và tính toán mật độ rầy</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 8: Mục tiêu cụ thể -->
    <section class="slide-section" data-slide="8" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.3.2. Mục tiêu nghiên cứu cụ thể</h2>
                
                <div class="content-body">
                    <div class="steps-layout" style="padding: 0;">
                        <div class="step-item">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h3>Huấn luyện YOLO</h3>
                                <p>Phát hiện và phân loại ba loại đối tượng: <b>rầy nâu</b>, <b>rầy lưng trắng</b> và <b>sâu ăn lá lúa</b></p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h3>Tích hợp SAM-ViT</h3>
                                <p>Phân đoạn <b>pixel-level</b> dựa trên bounding boxes từ YOLO, đảm bảo tách biệt chính xác giữa rầy và nền ruộng phức tạp</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h3>Khai thác ViT</h3>
                                <p>Sử dụng cơ chế <b>tự chú ý toàn cục (global self-attention)</b> nhằm nâng cao khả năng nhận diện đặc trưng hình thái của các đối tượng nhỏ, phân tán hoặc bị che khuất</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h3>Đánh giá hiệu quả</h3>
                                <p>Sử dụng các chỉ số: <b>IoU</b>, <b>Dice coefficient</b>, <b>Precision</b>, <b>Recall</b> và <b>F1-score</b> để đo lường hiệu suất phân đoạn</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h3>So sánh và Phân tích</h3>
                                <p>So sánh kết quả pipeline YOLO + SAM-ViT với <b>SwinT-YOLOv8-p2</b>, xác định ưu điểm và hạn chế của phương pháp đề xuất</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 9: Đối tượng và quy mô - Phạm vi -->
    <section class="slide-section" data-slide="9" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.4. Đối tượng và quy mô nghiên cứu</h2>
                <h3 style="color: #00796b; font-size: 32px; margin-bottom: 25px;">1.4.1. Phạm vi</h3>
                
                <div class="content-body">
                    <div style="background: #fff3cd; padding: 25px; border-radius: 12px; margin-bottom: 25px; border-left: 5px solid #ffc107;">
                        <h3 style="color: #856404; font-size: 24px; margin-bottom: 15px;">
                            <i class="fa-solid fa-database" style="margin-right: 10px;"></i>
                            Bộ dữ liệu
                        </h3>
                        <p style="font-size: 18px; color: #856404;">
                            Kế thừa từ <b>SwinT–YOLOv8–p2</b>, bao gồm các ảnh thực địa của:
                        </p>
                        <ul style="margin-top: 15px;">
                            <li><i class="fa-solid fa-bug" style="color: #856404;"></i> Rầy nâu (Brown planthopper)</li>
                            <li><i class="fa-solid fa-bug" style="color: #856404;"></i> Rầy lưng trắng (Whitebacked planthopper)</li>
                            <li><i class="fa-solid fa-bug" style="color: #856404;"></i> Sâu ăn lá lúa (Rice leaf miner)</li>
                        </ul>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3><i class="fa-solid fa-project-diagram" style="margin-right: 10px;"></i>Phạm vi nghiên cứu</h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Pipeline hai giai đoạn:</b> YOLO phát hiện và phân loại → SAM-ViT phân đoạn pixel-level</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Phân loại và phân đoạn:</b> Nhận dạng ba loại đối tượng, phân đoạn chính xác theo pixel và tính mật độ rầy</li>
                                <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> <b>Giới hạn:</b> Không mở rộng sang dự báo lan truyền dịch hại; tập trung vào phân loại và xác định mật độ</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 10: Đối tượng và quy mô - Đối tượng -->
    <section class="slide-section" data-slide="10" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.4.2. Đối tượng</h2>
                
                <div class="content-body">
                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3 style="color: #4caf50;">
                                <i class="fa-solid fa-bug" style="margin-right: 10px;"></i>
                                Đối tượng Sinh học
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-circle" style="color: #4caf50; font-size: 8px;"></i> <b>Rầy nâu</b> (Nilaparvata lugens)</li>
                                <li><i class="fa-solid fa-circle" style="color: #4caf50; font-size: 8px;"></i> <b>Rầy lưng trắng</b> (Sogatella furcifera)</li>
                                <li><i class="fa-solid fa-circle" style="color: #4caf50; font-size: 8px;"></i> <b>Sâu ăn lá lúa</b> (Rice leaf miner)</li>
                                <li style="margin-top: 10px; font-size: 17px; color: #666;">Xuất hiện trong ảnh thực địa trên ruộng lúa</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3 style="color: #2196f3;">
                                <i class="fa-solid fa-brain" style="margin-right: 10px;"></i>
                                Đối tượng Kỹ thuật
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-robot" style="color: #2196f3;"></i> <b>YOLO</b> (YOLOv8) - Phát hiện và phân loại</li>
                                <li><i class="fa-solid fa-puzzle-piece" style="color: #2196f3;"></i> <b>SAM</b> với <b>ViT-H backbone</b> - Phân đoạn pixel-level</li>
                                <li><i class="fa-solid fa-cogs" style="color: #2196f3;"></i> Quy trình huấn luyện, tích hợp và đánh giá pipeline YOLO + SAM-ViT</li>
                                <li style="margin-top: 10px; font-size: 17px; color: #666;">Cho phân loại và phân đoạn đối tượng nhỏ</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #ff9800;">
                            <h3 style="color: #ff9800;">
                                <i class="fa-solid fa-balance-scale" style="margin-right: 10px;"></i>
                                Đối tượng So sánh
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-chart-bar" style="color: #ff9800;"></i> Mô hình <b>SwinT–YOLOv8–p2</b></li>
                                <li><i class="fa-solid fa-check" style="color: #ff9800;"></i> Được sử dụng làm <b>chuẩn</b> để đánh giá độ chính xác</li>
                                <li><i class="fa-solid fa-check" style="color: #ff9800;"></i> Đánh giá khả năng nhận diện và đếm đối tượng trong điều kiện thực địa</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 11: Nội dung nghiên cứu -->
    <section class="slide-section" data-slide="11" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.5. Nội dung và kỹ thuật nghiên cứu</h2>
                <h3 style="color: #00796b; font-size: 32px; margin-bottom: 25px;">1.5.1. Nội dung nghiên cứu</h3>
                
                <div class="content-body">
                    <div class="steps-layout" style="padding: 0;">
                        <div class="step-item">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h3>Khảo sát và chuẩn hóa dữ liệu</h3>
                                <p>Sử dụng bộ dữ liệu từ SwinT–YOLOv8–p2. Phân tích đặc điểm dataset: định dạng ảnh, mask, cấu trúc thư mục, phân bố class, số lượng instances. Chuẩn hóa kích thước ảnh về 224×224 pixels.</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h3>Huấn luyện YOLO</h3>
                                <p>Xây dựng mô hình YOLO để phát hiện và phân loại ba loại đối tượng. Chuẩn hóa dữ liệu, xử lý mất cân bằng class, huấn luyện và đánh giá bằng Precision, Recall, F1-score, mAP.</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h3>Tích hợp SAM-ViT</h3>
                                <p>Dùng bounding boxes từ YOLO làm prompt, SAM trích xuất mặt nạ phân đoạn pixel-level. ViT-H backbone học đặc trưng toàn cục, kết hợp với SAM qua cơ chế feature fusion và attention guidance.</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h3>Phân tích kết quả và đề xuất hướng mở rộng</h3>
                                <p>So sánh kết quả pipeline YOLO + SAM-ViT với SwinT–YOLOv8–p2. Tính mật độ rầy dựa trên kết quả phân đoạn pixel-level. Thực hiện ablation study và đề xuất hướng mở rộng.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 12: Kỹ thuật nghiên cứu -->
    <section class="slide-section" data-slide="12" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">1.5.2. Kỹ thuật nghiên cứu</h2>
                
                <div class="content-body">
                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3 style="color: #4caf50;">
                                <i class="fa-solid fa-robot" style="margin-right: 10px;"></i>
                                YOLOv8
                            </h3>
                            <p style="font-size: 18px; margin-bottom: 10px;">Phát hiện và phân loại ba loại đối tượng, trả về bounding boxes, class và confidence score. Fine-tuning trên dataset rầy nâu với data augmentation.</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3 style="color: #2196f3;">
                                <i class="fa-solid fa-puzzle-piece" style="margin-right: 10px;"></i>
                                SAM-ViT
                            </h3>
                            <p style="font-size: 18px; margin-bottom: 10px;">ViT-H trích xuất đặc trưng toàn cục, SAM sử dụng bounding boxes từ YOLO làm prompts để phân đoạn pixel-level, giảm nhiễu từ nền và ánh sáng.</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #ff9800;">
                            <h3 style="color: #ff9800;">
                                <i class="fa-solid fa-project-diagram" style="margin-right: 10px;"></i>
                                Pipeline hai giai đoạn
                            </h3>
                            <p style="font-size: 18px; margin-bottom: 10px;">YOLO detection → SAM-ViT segmentation → kết hợp boxes, masks, class, score.</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #9c27b0;">
                            <h3 style="color: #9c27b0;">
                                <i class="fa-solid fa-chart-bar" style="margin-right: 10px;"></i>
                                Huấn luyện và đánh giá
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> YOLO fine-tuning với early stopping</li>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> SAM inference với box prompts</li>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> Metrics: mAP, Precision, Recall, F1 (detection); IoU, Dice (segmentation)</li>
                                <li><i class="fa-solid fa-check" style="color: #9c27b0;"></i> Mật độ rầy = số đối tượng / diện tích ảnh</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 13: CHƯƠNG 2 - Giới thiệu -->
    <section class="slide-section" data-slide="13" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="title-layout" style="background: linear-gradient(135deg, #1565c0 0%, #0d47a1 100%);">
                <h1 style="font-size: 48px; margin-bottom: 30px;">
                    <i class="fa-solid fa-book" style="margin-right: 20px;"></i>
                    CHƯƠNG 2
                </h1>
                <p class="subtitle" style="font-size: 36px; font-weight: 600;">
                    CƠ SỞ LÝ THUYẾT
                </p>
                <div style="margin-top: 50px; font-size: 22px; opacity: 0.95;">
                    <p><i class="fa-solid fa-brain" style="margin-right: 10px;"></i>Thị giác máy tính và Học sâu</p>
                    <p><i class="fa-solid fa-puzzle-piece" style="margin-right: 10px;"></i>Segment Anything Model (SAM)</p>
                    <p><i class="fa-solid fa-eye" style="margin-right: 10px;"></i>Vision Transformer (ViT)</p>
                    <p><i class="fa-solid fa-project-diagram" style="margin-right: 10px;"></i>Pipeline YOLO + SAM-ViT</p>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 14: Thị giác máy tính -->
    <section class="slide-section" data-slide="14" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">2.1.1. Thị giác máy tính (Computer Vision)</h2>
                
                <div class="content-body">
                    <div style="background: #e3f2fd; padding: 25px; border-radius: 12px; margin-bottom: 25px; border-left: 5px solid #2196f3;">
                        <h3 style="color: #1565c0; font-size: 24px; margin-bottom: 15px;">
                            <i class="fa-solid fa-eye" style="margin-right: 10px;"></i>
                            Định nghĩa
                        </h3>
                        <p style="font-size: 18px; line-height: 1.6;">
                            Lĩnh vực nghiên cứu nhằm giúp máy tính có khả năng <b>"nhìn thấy"</b> và <b>hiểu nội dung</b> 
                            trong hình ảnh hoặc video tương tự như con người. Chuyển đổi dữ liệu thị giác thành thông tin 
                            có cấu trúc để phục vụ các tác vụ phân tích, nhận dạng và ra quyết định tự động.
                        </p>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3><i class="fa-solid fa-tag" style="margin-right: 10px;"></i>Phân loại ảnh</h3>
                            <p style="font-size: 17px; margin-bottom: 8px;"><b>Ưu điểm:</b> Mô hình đơn giản, tốc độ nhanh</p>
                            <p style="font-size: 17px;"><b>Hạn chế:</b> Không xác định vị trí đối tượng</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3><i class="fa-solid fa-square" style="margin-right: 10px;"></i>Phát hiện đối tượng</h3>
                            <p style="font-size: 17px; margin-bottom: 8px;"><b>Ưu điểm:</b> Phù hợp môi trường nhiều đối tượng</p>
                            <p style="font-size: 17px;"><b>Hạn chế:</b> Bounding box không mô tả hình dạng chi tiết</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #9c27b0; grid-column: 1 / -1;">
                            <h3><i class="fa-solid fa-mask" style="margin-right: 10px;"></i>Phân đoạn ảnh</h3>
                            <p style="font-size: 17px; margin-bottom: 8px;"><b>Ưu điểm:</b> Mô tả biên dạng chi tiết, phù hợp đối tượng nhỏ</p>
                            <p style="font-size: 17px;"><b>Hạn chế:</b> Yêu cầu dữ liệu gán nhãn phức tạp, mô hình nặng</p>
                            <p style="font-size: 17px; margin-top: 10px; color: #666;">
                                <b>Loại:</b> Semantic Segmentation (phân vùng theo loại) | Instance Segmentation (nhận diện từng cá thể)
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 15: Tầm quan trọng của phân đoạn -->
    <section class="slide-section" data-slide="15" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">Tầm quan trọng của Phân đoạn trong Phát hiện Sâu bệnh</h2>
                
                <div class="content-body">
                    <div style="background: #fff3cd; padding: 25px; border-radius: 12px; margin-bottom: 25px; border-left: 5px solid #ffc107;">
                        <h3 style="color: #856404; font-size: 24px; margin-bottom: 15px;">
                            <i class="fa-solid fa-exclamation-triangle" style="margin-right: 10px;"></i>
                            Thách thức Thực địa
                        </h3>
                        <ul>
                            <li><i class="fa-solid fa-bug" style="color: #856404;"></i> Rầy và sâu bệnh có <b>kích thước rất nhỏ</b></li>
                            <li><i class="fa-solid fa-palette" style="color: #856404;"></i> Màu sắc <b>tương tự nền lá</b></li>
                            <li><i class="fa-solid fa-eye-slash" style="color: #856404;"></i> Dễ bị <b>che khuất</b> hoặc chồng lấn</li>
                        </ul>
                    </div>

                    <div class="steps-layout" style="padding: 0;">
                        <div class="step-item">
                            <div class="step-number" style="background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);">1</div>
                            <div class="step-content">
                                <h3>Khoanh vùng chính xác</h3>
                                <p>Phân đoạn giúp khoanh vùng chính xác vùng chứa sâu bệnh ở <b>cấp độ pixel</b>, không chỉ ước lượng như bounding box</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number" style="background: linear-gradient(135deg, #2196f3 0%, #1565c0 100%);">2</div>
                            <div class="step-content">
                                <h3>Loại bỏ nhiễu</h3>
                                <p>Giúp loại bỏ nhiễu từ <b>nền ruộng</b>, <b>ánh sáng</b> và các <b>vật thể không liên quan</b></p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number" style="background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);">3</div>
                            <div class="step-content">
                                <h3>Cải thiện độ chính xác</h3>
                                <p>Cải thiện độ chính xác phân loại nhờ cung cấp <b>biểu diễn không gian tinh chỉnh</b></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 16: Học sâu - CNN -->
    <section class="slide-section" data-slide="16" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">2.1.2. Học sâu trong Computer Vision</h2>
                <h3 style="color: #00796b; font-size: 28px; margin-bottom: 25px;">Kiến trúc CNN (Convolutional Neural Network)</h3>
                
                <div class="content-body">
                    <div style="background: #e8f5e9; padding: 25px; border-radius: 12px; margin-bottom: 25px; border-left: 5px solid #4caf50;">
                        <p style="font-size: 18px; line-height: 1.6;">
                            Học sâu sử dụng các mô hình mạng nơ-ron nhiều tầng để học các đặc trưng phức tạp từ dữ liệu. 
                            Có khả năng học trực tiếp từ ảnh thô mà <b>không cần thiết kế thủ công đặc trưng</b>.
                        </p>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3><i class="fa-solid fa-filter" style="margin-right: 10px;"></i>Convolutional Layers</h3>
                            <p style="font-size: 17px;">Sử dụng các bộ lọc (kernels) để quét qua ảnh và trích xuất đặc trưng cục bộ như cạnh, góc, hoa văn. Các đặc trưng được học từ tầng thấp lên tầng sâu, tạo biểu diễn thị giác đa cấp độ.</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3><i class="fa-solid fa-compress" style="margin-right: 10px;"></i>Pooling Layers</h3>
                            <p style="font-size: 17px;">Giảm kích thước không gian bằng cách lấy giá trị cực đại (max pooling) hoặc trung bình (average pooling). Giúp giảm số lượng tham số, tăng tính khái quát và hạn chế overfitting.</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #9c27b0;">
                            <h3><i class="fa-solid fa-network-wired" style="margin-right: 10px;"></i>Fully Connected Layers</h3>
                            <p style="font-size: 17px;">Ánh xạ biểu diễn đặc trưng sang nhãn đầu ra. Đây thường là phần cuối của mô hình phân loại.</p>
                        </div>

                        <div style="background: #fff3cd; padding: 20px; border-radius: 12px; border-left: 4px solid #ffc107;">
                            <p style="color: #856404; font-size: 17px; margin: 0;">
                                <b>Hạn chế:</b> CNN giới hạn về khả năng nắm bắt quan hệ dài hạn giữa các vùng ảnh – 
                                lý do khiến <b>Transformers</b> dần thay thế trong nhiều tác vụ hiện đại.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 17: Transfer Learning và Pre-trained Models -->
    <section class="slide-section" data-slide="17" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">Transfer Learning & Pre-trained Models</h2>
                
                <div class="content-body">
                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3 style="color: #4caf50;">
                                <i class="fa-solid fa-exchange-alt" style="margin-right: 10px;"></i>
                                Transfer Learning
                            </h3>
                            <p style="font-size: 17px; margin-bottom: 12px;">Tận dụng tri thức của mô hình đã được huấn luyện trên nhiệm vụ lớn để hỗ trợ học tốt hơn ở nhiệm vụ khác có dữ liệu ít hơn.</p>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Giảm số lượng mẫu ảnh cần thiết</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Tăng tốc huấn luyện và cải thiện độ hội tụ</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Hiệu quả cao ngay cả khi dữ liệu mục tiêu có chất lượng không đồng đều</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3 style="color: #2196f3;">
                                <i class="fa-solid fa-database" style="margin-right: 10px;"></i>
                                ImageNet Pre-training
                            </h3>
                            <p style="font-size: 17px; margin-bottom: 12px;">Huấn luyện trên tập dữ liệu quy mô lớn: <b>1,2 triệu ảnh</b> và <b>1000 lớp</b>. Học các đặc trưng thị giác phổ quát.</p>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #2196f3;"></i> Cung cấp điểm khởi đầu tốt</li>
                                <li><i class="fa-solid fa-check" style="color: #2196f3;"></i> Giúp backbone ổn định hơn khi huấn luyện trên tập dữ liệu nhỏ</li>
                                <li><i class="fa-solid fa-check" style="color: #2196f3;"></i> Tăng độ chính xác và khả năng tổng quát hóa</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #ff9800; grid-column: 1 / -1;">
                            <h3 style="color: #ff9800;">
                                <i class="fa-solid fa-cogs" style="margin-right: 10px;"></i>
                                Fine-tuning
                            </h3>
                            <p style="font-size: 17px; margin-bottom: 12px;">Điều chỉnh trọng số của mô hình pre-trained nhằm phù hợp với bài toán mới.</p>
                            <div class="steps-layout" style="padding: 0; margin-top: 15px;">
                                <div style="display: flex; align-items: flex-start; margin-bottom: 10px;">
                                    <span style="background: #ff9800; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-right: 15px; flex-shrink: 0;">1</span>
                                    <p style="font-size: 17px; margin: 0;">Khởi tạo mô hình từ trọng số pre-trained</p>
                                </div>
                                <div style="display: flex; align-items: flex-start; margin-bottom: 10px;">
                                    <span style="background: #ff9800; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-right: 15px; flex-shrink: 0;">2</span>
                                    <p style="font-size: 17px; margin: 0;">Thay thế tầng phân loại cuối bằng lớp mới (ví dụ: 3 lớp rầy)</p>
                                </div>
                                <div style="display: flex; align-items: flex-start; margin-bottom: 10px;">
                                    <span style="background: #ff9800; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-right: 15px; flex-shrink: 0;">3</span>
                                    <p style="font-size: 17px; margin: 0;">Huấn luyện với learning rate nhỏ để điều chỉnh các tầng sâu</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 18: Bài toán đối tượng nhỏ -->
    <section class="slide-section" data-slide="18" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">2.1.3. Bài toán phát hiện và phân đoạn đối tượng nhỏ</h2>
                
                <div class="content-body">
                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #f44336;">
                            <h3 style="color: #f44336;">
                                <i class="fa-solid fa-exclamation-circle" style="margin-right: 10px;"></i>
                                Đặc điểm Đối tượng Nhỏ
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-ruler" style="color: #f44336;"></i> Kích thước vật thể <b>nhỏ so với toàn cảnh ảnh</b></li>
                                <li><i class="fa-solid fa-eye-slash" style="color: #f44336;"></i> Dễ bị <b>nhiễu nền</b> hoặc <b>che khuất (occlusion)</b></li>
                                <li><i class="fa-solid fa-layer-group" style="color: #f44336;"></i> Nhiều instances có kích thước và hình dạng khác nhau trong cùng một ảnh</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #ff9800;">
                            <h3 style="color: #ff9800;">
                                <i class="fa-solid fa-tasks" style="margin-right: 10px;"></i>
                                Thách thức
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-slash" style="color: #ff9800;"></i> Biên giới của đối tượng <b>không rõ ràng</b></li>
                                <li><i class="fa-solid fa-balance-scale" style="color: #ff9800;"></i> Tỷ lệ <b>background so với foreground lớn</b></li>
                                <li><i class="fa-solid fa-compress" style="color: #ff9800;"></i> Nhiều object gần nhau gây <b>chồng lấn</b></li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3 style="color: #2196f3;">
                                <i class="fa-solid fa-tools" style="margin-right: 10px;"></i>
                                Phương pháp Tiếp cận
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-mask" style="color: #2196f3;"></i> <b>Instance Segmentation:</b> Nhận diện và phân đoạn từng instance riêng biệt (Mask R-CNN, SAM)</li>
                                <li><i class="fa-solid fa-tag" style="color: #2196f3;"></i> <b>Semantic Segmentation:</b> Gán nhãn pixel theo class, không phân biệt instances (U-Net, DeepLabv3)</li>
                            </ul>
                        </div>

                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3 style="color: #4caf50;">
                                <i class="fa-solid fa-chart-line" style="margin-right: 10px;"></i>
                                Chỉ số Đánh giá
                            </h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>IoU</b> (Intersection over Union): Đo độ trùng khớp giữa predicted mask và ground truth</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Dice coefficient:</b> Đánh giá độ chính xác phân đoạn, nhạy với các object nhỏ</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Pixel accuracy:</b> Tỷ lệ pixel được phân loại đúng trên toàn bộ ảnh</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 19: SAM - Giới thiệu -->
    <section class="slide-section" data-slide="19" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">2.2. Segment Anything Model (SAM)</h2>
                <h3 style="color: #00796b; font-size: 32px; margin-bottom: 25px;">2.2.1. Giới thiệu về SAM</h3>
                
                <div class="content-body">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 15px; color: white; margin-bottom: 25px;">
                        <h3 style="color: white; font-size: 28px; margin-bottom: 15px;">
                            <i class="fa-solid fa-star" style="margin-right: 10px;"></i>
                            Mô hình Phân đoạn Tiên tiến
                        </h3>
                        <p style="font-size: 19px; line-height: 1.7; color: white;">
                            Được <b>Meta AI</b> phát triển, nổi bật với khả năng <b>zero-shot segmentation</b>, 
                            cho phép phân đoạn các đối tượng <b>chưa từng xuất hiện</b> trong dữ liệu huấn luyện.
                        </p>
                        <p style="font-size: 18px; margin-top: 15px; color: rgba(255,255,255,0.9);">
                            <b>Huấn luyện:</b> SA-1B với <b>11 triệu ảnh</b> và <b>1,1 tỷ masks</b>
                        </p>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3 style="color: #4caf50; font-size: 20px;">
                                <i class="fa-solid fa-image" style="margin-right: 8px;"></i>
                                Image Encoder
                            </h3>
                            <p style="font-size: 16px;">Trích xuất đặc trưng từ ảnh đầu vào, cung cấp representation phong phú và chi tiết về các đối tượng</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #2196f3;">
                            <h3 style="color: #2196f3; font-size: 20px;">
                                <i class="fa-solid fa-keyboard" style="margin-right: 8px;"></i>
                                Prompt Encoder
                            </h3>
                            <p style="font-size: 16px;">Nhận các chỉ dẫn (prompt) như điểm, bounding box, hoặc mask sơ bộ, giúp mô hình tập trung phân đoạn theo vùng quan tâm</p>
                        </div>

                        <div class="grid-item" style="border-left-color: #9c27b0;">
                            <h3 style="color: #9c27b0; font-size: 20px;">
                                <i class="fa-solid fa-mask" style="margin-right: 8px;"></i>
                                Mask Decoder
                            </h3>
                            <p style="font-size: 16px;">Sinh ra mask phân đoạn cuối cùng dựa trên feature map từ Image Encoder và Prompt Encoder</p>
                        </div>
                    </div>

                    <div style="background: #e8f5e9; padding: 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid #4caf50;">
                        <p style="font-size: 17px; color: #2e7d32; margin: 0;">
                            <b>Ưu điểm:</b> Khả năng zero-shot làm cho SAM thích hợp với các bài toán nông nghiệp, 
                            nơi mà các loại sâu, rầy và lá cây có thể đa dạng và ít dữ liệu được gán nhãn.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 20: SAM Encoder -->
    <section class="slide-section" data-slide="20" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">2.2.2. Kiến trúc SAM Encoder</h2>
                
                <div class="content-body">
                    <div style="background: #e3f2fd; padding: 25px; border-radius: 12px; margin-bottom: 25px; border-left: 5px solid #2196f3;">
                        <h3 style="color: #1565c0; font-size: 24px; margin-bottom: 15px;">
                            <i class="fa-solid fa-brain" style="margin-right: 10px;"></i>
                            Vision Transformer (ViT) Backbone
                        </h3>
                        <ul>
                            <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Dựa trên <b>Vision Transformer (ViT)</b></li>
                            <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Các phiên bản: <b>ViT-B</b>, <b>ViT-L</b>, <b>ViT-H</b></li>
                            <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Ảnh đầu vào: <b>1024×1024 pixels</b></li>
                            <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Feature map output: <b>256 chiều</b></li>
                        </ul>
                    </div>

                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                        <div class="grid-item" style="border-left-color: #4caf50;">
                            <h3><i class="fa-solid fa-check-circle" style="margin-right: 10px;"></i>Lợi ích của Frozen Feature Extractor</h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Đặc trưng không gian phong phú được học từ bộ dữ liệu <b>SA-1B</b></li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Giúp mô hình <b>ổn định và chính xác</b> trong việc phân đoạn các vùng ROI</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Giảm chi phí tính toán khi kết hợp với ViT trong nhiệm vụ phân loại</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Tăng tính <b>robust</b> của mô hình trong môi trường thực địa với nhiều yếu tố nhiễu</li>
                            </ul>
                        </div>

                        <div style="background: #fff3cd; padding: 20px; border-radius: 12px; border-left: 4px solid #ffc107;">
                            <p style="color: #856404; font-size: 17px; margin: 0;">
                                SAM Encoder cung cấp đặc trưng không gian chi tiết và là <b>nền tảng</b> để kết hợp với ViT, 
                                xây dựng mô hình hybrid <b>SAM–ViT</b> mạnh mẽ cho bài toán nhận dạng và phân đoạn rầy.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 13: CHƯƠNG 3 - Pipeline tổng thể -->
    <section class="slide-section" data-slide="21" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">CHƯƠNG 3: THIẾT KẾ VÀ XÂY DỰNG HỆ THỐNG</h2>
                <h3 style="color: #00796b; font-size: 32px; margin-bottom: 25px;">3.1. Pipeline tổng thể của mô hình</h3>
                
                <div class="content-body">
                    <div class="steps-layout" style="padding: 0;">
                        <div class="step-item">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h3>Input Image (Ảnh RGB đầu vào)</h3>
                                <p>Nhận ảnh thực địa từ ruộng lúa chứa rầy nâu, rầy lưng trắng và sâu ăn lá lúa</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h3>YOLO Detection & Classification</h3>
                                <p>Phát hiện và phân loại đối tượng, trả về: <b>Bounding Boxes</b>, <b>Class Labels</b>, <b>Confidence Scores</b></p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h3>Box Transformation</h3>
                                <p>Chuyển đổi bounding boxes từ YOLO sang định dạng prompts cho SAM</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h3>SAM-ViT Segmentation</h3>
                                <p>Sử dụng boxes làm prompts để tạo <b>Segmentation Masks pixel-level</b> chính xác</p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h3>Merge Results</h3>
                                <p>Kết hợp: <b>Boxes</b> (YOLO) + <b>Masks</b> (SAM) + <b>Classes</b> + <b>Scores</b></p>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <h3>Visualization & Density Calculation</h3>
                                <p>Trực quan hóa kết quả và tính toán <b>mật độ rầy/m²</b></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 22: Tiền xử lý dữ liệu -->
    <section class="slide-section" data-slide="22" onclick="if(document.body.classList.contains('fullscreen')) changeSlide(1)">
        <div class="slide-container">
            <div class="content-layout">
                <h2 class="slide-title" style="color: #1565c0;">3.2. Quy trình tiền xử lý dữ liệu</h2>
                
                <div class="content-body">
                    <div class="grid-body" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="grid-item">
                            <h3><i class="fa-solid fa-folder-open" style="margin-right: 10px;"></i>Kiểm tra cấu trúc Dataset</h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Xác nhận thư mục images/ và labels/</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Tìm kiếm file ảnh (.jpg, .jpeg, .png)</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Tìm kiếm file nhãn (.txt)</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Đối chiếu ảnh và nhãn</li>
                            </ul>
                        </div>

                        <div class="grid-item">
                            <h3><i class="fa-solid fa-sitemap" style="margin-right: 10px;"></i>Cấu trúc thư mục YOLO</h3>
                            <ul>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Train:</b> 1830 ảnh</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Validation:</b> 1211 ảnh</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> <b>Test:</b> 203 ảnh</li>
                                <li><i class="fa-solid fa-check" style="color: #4caf50;"></i> Định dạng nhãn YOLO: class_id x_center y_center width height</li>
                            </ul>
                        </div>

                        <div class="grid-item">
                            <h3><i class="fa-solid fa-image" style="margin-right: 10px;"></i>Đặc điểm ảnh</h3>
                            <ul>
                                <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Kích thước trung bình: <b>5921×4079 pixels</b></li>
                                <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Nhỏ nhất: 4000×4000 pixels</li>
                                <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Lớn nhất: 6000×6000 pixels</li>
                                <li><i class="fa-solid fa-info-circle" style="color: #2196f3;"></i> Ảnh thực địa từ ruộng lúa</li>
                            </ul>
                        </div>

                        <div class="grid-item">
                            <h3><i class="fa-solid fa-tags" style="margin-right: 10px;"></i>Class Mapping</h3>
                            <ul>
                                <li><i class="fa-solid fa-circle" style="color: #4caf50; font-size: 10px;"></i> Class 0: <b>Rầy lưng trắng</b> (Whitebacked planthopper)</li>
                                <li><i class="fa-solid fa-circle" style="color: #2196f3; font-size: 10px;"></i> Class 1: <b>Sâu ăn lá lúa</b> (Rice leaf miner)</li>
                                <li><i class="fa-solid fa-circle" style="color: #f44336; font-size: 10px;"></i> Class 2: <b>Rầy nâu</b> (Brown planthopper)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Thumbnail Navigation Bar -->
    <div class="thumbnail-bar" id="thumbnailBar"></div>

    <script>
        // Slide Navigation
        let currentSlideIndex = 1;
        const slides = document.querySelectorAll('.slide-section');
        const totalSlides = slides.length;

        // Update slide counter
        function updateSlideCounter() {
            document.getElementById('currentSlide').textContent = currentSlideIndex;
            document.getElementById('totalSlides').textContent = totalSlides;
        }

        // Change slide
        function changeSlide(direction) {
            const newIndex = currentSlideIndex + direction;
            if (newIndex < 1 || newIndex > totalSlides) return;

            // Hide current slide
            document.querySelector(`.slide-section[data-slide="${currentSlideIndex}"]`).classList.remove('active');
            
            // Show new slide
            currentSlideIndex = newIndex;
            document.querySelector(`.slide-section[data-slide="${currentSlideIndex}"]`).classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            // Update counter and buttons
            updateSlideCounter();
            updateNavButtons();
            updateThumbnails();
        }

        // Go to specific slide
        function goToSlide(slideNumber) {
            if (slideNumber < 1 || slideNumber > totalSlides) return;
            
            document.querySelector(`.slide-section[data-slide="${currentSlideIndex}"]`).classList.remove('active');
            currentSlideIndex = slideNumber;
            document.querySelector(`.slide-section[data-slide="${currentSlideIndex}"]`).classList.add('active');
            
            window.scrollTo(0, 0);
            updateSlideCounter();
            updateNavButtons();
            updateThumbnails();
        }

        // Update navigation buttons
        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentSlideIndex === 1;
            nextBtn.disabled = currentSlideIndex === totalSlides;
        }

        // Fullscreen functions
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                enterFullscreen();
            } else {
                exitFullscreen();
            }
        }

        function enterFullscreen() {
            document.body.classList.add('fullscreen');
            const btn = document.getElementById('fullscreenBtn');
            btn.innerHTML = '<i class="fa-solid fa-compress"></i> Thoát toàn màn hình';
            
            // Add click handlers to all slides
            slides.forEach(slide => {
                slide.addEventListener('click', handleSlideClick);
            });
        }

        function exitFullscreen() {
            document.body.classList.remove('fullscreen');
            const btn = document.getElementById('fullscreenBtn');
            btn.innerHTML = '<i class="fa-solid fa-expand"></i> Toàn màn hình';
            
            // Remove click handlers
            slides.forEach(slide => {
                slide.removeEventListener('click', handleSlideClick);
            });
        }

        function handleSlideClick(e) {
            // Only advance if clicking on the slide itself, not on buttons or links
            if (e.target.closest('.nav-btn, .download-btn, .fullscreen-btn, a, button, .slide-container')) {
                return;
            }
            // Check if click is on the right side (next) or left side (previous)
            const slide = e.currentTarget;
            const rect = slide.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const slideWidth = rect.width;
            
            if (clickX > slideWidth / 2) {
                changeSlide(1); // Click right side - next
            } else {
                changeSlide(-1); // Click left side - previous
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'Escape' && document.body.classList.contains('fullscreen')) {
                exitFullscreen();
            }
            if (e.key === 'F11') {
                e.preventDefault();
                toggleFullscreen();
            }
        });

        // Create thumbnails with actual slide previews
        async function createThumbnails() {
            const thumbnailBar = document.getElementById('thumbnailBar');
            thumbnailBar.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">Đang tạo thumbnail...</div>';
            
            // Store original states
            const originalStates = [];
            slides.forEach(slide => {
                originalStates.push({
                    display: slide.style.display,
                    active: slide.classList.contains('active')
                });
            });
            
            // Show all slides temporarily for capture
            slides.forEach(slide => {
                slide.style.display = 'flex';
                slide.style.position = 'absolute';
                slide.style.left = '-9999px';
                slide.style.top = '0';
            });
            
            await new Promise(resolve => setTimeout(resolve, 100));
            
            thumbnailBar.innerHTML = '';
            
            for (let index = 0; index < slides.length; index++) {
                const slide = slides[index];
                const thumbnail = document.createElement('div');
                thumbnail.className = 'thumbnail-item';
                thumbnail.dataset.slide = index + 1;
                
                try {
                    // Try to capture actual slide preview
                    if (typeof html2canvas !== 'undefined') {
                        const slideContainer = slide.querySelector('.slide-container');
                        if (slideContainer) {
                            const canvas = await html2canvas(slideContainer, {
                                scale: 0.2,
                                width: 120,
                                height: 80,
                                useCORS: true,
                                logging: false,
                                backgroundColor: '#fff',
                                windowWidth: 1280,
                                windowHeight: 720
                            });
                            canvas.style.width = '100%';
                            canvas.style.height = '100%';
                            thumbnail.appendChild(canvas);
                        } else {
                            throw new Error('No container found');
                        }
                    } else {
                        throw new Error('html2canvas not available');
                    }
                } catch (error) {
                    // Fallback to simple canvas
                    const canvas = document.createElement('canvas');
                    canvas.width = 120;
                    canvas.height = 80;
                    const ctx = canvas.getContext('2d');
                    
                    // Background gradient
                    const gradient = ctx.createLinearGradient(0, 0, 120, 80);
                    gradient.addColorStop(0, '#667eea');
                    gradient.addColorStop(1, '#764ba2');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, 120, 80);
                    
                    // Text
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(`Slide ${index + 1}`, 60, 40);
                    
                    thumbnail.appendChild(canvas);
                }
                
                const number = document.createElement('div');
                number.className = 'thumbnail-number';
                number.textContent = index + 1;
                thumbnail.appendChild(number);
                
                thumbnail.addEventListener('click', () => goToSlide(index + 1));
                
                thumbnailBar.appendChild(thumbnail);
            }
            
            // Restore original states
            slides.forEach((slide, index) => {
                slide.style.display = originalStates[index].display || '';
                slide.style.position = '';
                slide.style.left = '';
                slide.style.top = '';
                if (originalStates[index].active) {
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                }
            });
            
            // Ensure current slide is visible
            slides[currentSlideIndex - 1].classList.add('active');
            
            updateThumbnails();
            
            // Add mouse wheel scroll for horizontal scrolling
            thumbnailBar.addEventListener('wheel', (e) => {
                e.preventDefault();
                // Use deltaY for vertical wheel, convert to horizontal scroll
                thumbnailBar.scrollLeft += e.deltaY;
            }, { passive: false });
        }

        function updateThumbnails() {
            document.querySelectorAll('.thumbnail-item').forEach((item, index) => {
                if (index + 1 === currentSlideIndex) {
                    item.classList.add('active');
                    item.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // Initialize
        updateSlideCounter();
        updateNavButtons();
        createThumbnails();
        
        // Handle fullscreen API
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                exitFullscreen();
            }
        });

        async function downloadPDF() {
            try {
                const btn = document.querySelector('.download-btn');
                btn.disabled = true;
                btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Đang tạo PDF...';
                
                // Ẩn nút download
                btn.style.display = 'none';
                
                // Lấy tất cả slide sections
                const slides = document.querySelectorAll('.slide-section');
                
                if (slides.length === 0) {
                    throw new Error('Không tìm thấy slide nào');
                }
                
                // Kiểm tra thư viện
                if (typeof html2canvas === 'undefined') {
                    throw new Error('html2canvas chưa được tải. Vui lòng tải lại trang.');
                }
                
                if (typeof jspdf === 'undefined') {
                    throw new Error('jsPDF chưa được tải. Vui lòng tải lại trang.');
                }
                
                // Tạo PDF từng slide một để đảm bảo chất lượng
                const { jsPDF } = jspdf;
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'in',
                    format: [10, 7.2] // 1280x720px tỷ lệ 16:9
                });
                
                // Render từng slide
                for (let i = 0; i < slides.length; i++) {
                    const slide = slides[i];
                    
                    // Scroll đến slide để đảm bảo render đúng
                    slide.scrollIntoView({ behavior: 'instant', block: 'center' });
                    
                    // Đợi để browser render
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // Render slide thành canvas với chất lượng cao
                    const canvas = await html2canvas(slide, {
                        scale: 2.5, // Chất lượng cao
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: '#f0f2f5',
                        logging: false,
                        width: slide.offsetWidth || 1280,
                        height: slide.offsetHeight || 720,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    // Chuyển canvas thành image
                    const imgData = canvas.toDataURL('image/png', 1.0);
                    
                    // Thêm vào PDF (trừ slide đầu tiên)
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    // Tính toán kích thước để fit vào trang
                    const imgWidth = 10;
                    const imgHeight = (canvas.height / canvas.width) * 10;
                    
                    // Thêm image vào PDF
                    pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, Math.min(imgHeight, 7.2), undefined, 'FAST');
                }
                
                // Lưu file
                pdf.save('BaoCao_RayNau.pdf');
                
                // Hiện lại nút download
                btn.style.display = 'block';
                btn.disabled = false;
                btn.innerHTML = '<i class="fa-solid fa-file-pdf"></i> Tải PDF';
                
                alert('Đã tạo file PDF thành công với ' + slides.length + ' slide!');
            } catch (error) {
                console.error('Lỗi khi tạo PDF:', error);
                alert('Có lỗi xảy ra khi tạo file PDF. Vui lòng thử lại.\n' + error.message);
                const btn = document.querySelector('.download-btn');
                btn.style.display = 'block';
                btn.disabled = false;
                btn.innerHTML = '<i class="fa-solid fa-file-pdf"></i> Tải PDF';
            }
        }
    </script>
</body>
</html>

